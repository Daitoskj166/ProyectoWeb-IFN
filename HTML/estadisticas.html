<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Generar Reporte - IFN</title>
  <!-- 
    ENLACE AL ARCHIVO CSS ESPEC√çFICO PARA ESTILOS DE REPORTES
    Prop√≥sito: Define los estilos visuales espec√≠ficos para la p√°gina de reportes
    Ubicaci√≥n: Archivo CSS en la carpeta ../CSS/
  -->
  <link rel="stylesheet" href="../CSS/styles-Estadisticas.css">
  
  <!-- 
    IMPORTACI√ìN DE CHART.JS PARA GENERAR GR√ÅFICOS INTERACTIVOS
    Prop√≥sito: Biblioteca externa para la creaci√≥n de gr√°ficos din√°micos y responsivos
    Fuente: CDN de Chart.js para optimizar el tiempo de carga
  -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <!-- ===== ENCABEZADO PRINCIPAL ===== -->
  <header>
    <!-- 
      LOGO DEL INSTITUTO DE HIDROLOG√çA, METEOROLOG√çA Y ESTUDIOS AMBIENTALES
      Prop√≥sito: Identificaci√≥n visual de la instituci√≥n
      Atributos:
        - class: "Logo" para estilos espec√≠ficos
        - src: Ruta de la imagen del logo
        - alt: Texto alternativo para accesibilidad
        - width: Ancho fijo para consistencia visual
    -->
    <img class="Logo" src="../IMG/ifn-baja-tcm30-525131.png" alt="Logo IFN" width="150">
    
    <!-- CONTENEDOR CENTRAL DEL HEADER CON T√çTULO Y NAVEGACI√ìN -->
    <div class="center-header">
      <!-- 
        T√çTULO PRINCIPAL DEL SISTEMA
        Prop√≥sito: Identificar claramente la aplicaci√≥n y su alcance nacional
      -->
      <h1>INVENTARIO FORESTAL NACIONAL - COLOMBIA</h1>
      
      <!-- 
        MEN√ö DE NAVEGACI√ìN PRINCIPAL - DASHBOARD
        Prop√≥sito: Permitir la navegaci√≥n entre diferentes m√≥dulos del sistema
        Estructura: Enlaces con clase "dashboard-btn" para estilos consistentes
      -->
      <div class="dashboard">
        <a href="inicio-Pantalla.html" class="dashboard-btn">Inicio</a>
        <a href="subirArbol.html" class="dashboard-btn">Subir Arbol</a>
        <a href="subirSuelo.html" class="dashboard-btn">Subir Suelo</a>
        <a href="registro.html" class="dashboard-btn">Registro</a>
        <a href="gestionBrigadas.html" class="dashboard-btn">Gesti√≥n Brigadas</a>
        <a href="supervision.html" class="dashboard-btn">Supervisi√≥n</a>
      </div>
    </div>

    <!-- 
      SECCI√ìN DE INFORMACI√ìN DEL USUARIO
      Prop√≥sito: Mostrar informaci√≥n del usuario logueado y opci√≥n de cierre de sesi√≥n
      Componentes:
        - texto-arriba: Nombre del usuario
        - Login: Imagen de perfil del usuario
        - texto-abajo: Bot√≥n para cerrar sesi√≥n
    -->
    <div class="login-imagen">
      <p class="texto-arriba">User</p>
      <img class="Login" src="../IMG/login.png" alt="Login User" width="150">
      <button class="texto-abajo">Cerrar sesi√≥n</button>
    </div>
  </header>

  <!-- 
    BANNER QUE MUESTRA EL ESTADO DE CONEXI√ìN DEL SISTEMA
    Prop√≥sito: Informar al usuario sobre el estado de conectividad y guardado autom√°tico
    Elementos visuales:
      - banner-icon: Indicador visual del estado (üü¢ para conectado)
      - banner-texto: Descripci√≥n textual del estado
  -->
  <div class="banner-conectado">
    <span class="banner-icon">üü¢</span>
    <span class="banner-texto">En l√≠nea - Datos se guardan autom√°ticamente</span>
  </div>

  <!-- ===== CONTENIDO PRINCIPAL DE LA P√ÅGINA ===== -->
  <main>
    <!-- 
      T√çTULO PRINCIPAL DE LA P√ÅGINA
      Prop√≥sito: Indicar claramente la funcionalidad principal de esta vista
    -->
    <h1>GENERAR REPORTES</h1>
    
    <!-- 
      SECCI√ìN DE FILTROS PARA PERSONALIZAR EL REPORTE
      Prop√≥sito: Permitir al usuario definir par√°metros espec√≠ficos para el reporte
    -->
    <div class="filtros-reporte">
      <h2>Personalizar Reporte</h2>
      
      <!-- 
        GRID RESPONSIVO PARA ORGANIZAR LOS FILTROS
        Prop√≥sito: Dise√±o adaptable que se ajusta a diferentes tama√±os de pantalla
      -->
      <div class="filtros-grid">
        <!-- 
          FILTRO POR TIPO DE REPORTE (OBLIGATORIO)
          Prop√≥sito: Seleccionar la categor√≠a principal del reporte a generar
          Validaci√≥n: Campo requerido (atributo required)
        -->
        <div class="filtro-grupo">
          <label for="tipo-reporte">Tipo de Reporte *</label>
          <select id="tipo-reporte" required>
            <option value="">Seleccionar tipo</option>
            <option value="arboles">Reporte de √Årboles</option>
            <option value="suelos">Reporte de Suelos</option>
            <option value="especies">Distribuci√≥n de Especies</option>
            <option value="crecimiento">An√°lisis de Crecimiento</option>
            <option value="salud">Estado de Salud Forestal</option>
          </select>
        </div>
        
        <!-- 
          FILTRO POR PER√çODO DE TIEMPO (OBLIGATORIO)
          Prop√≥sito: Definir el rango temporal para el reporte
          Validaci√≥n: Campo requerido (atributo required)
        -->
        <div class="filtro-grupo">
          <label for="periodo">Per√≠odo *</label>
          <select id="periodo" required>
            <option value="">Seleccionar per√≠odo</option>
            <option value="hoy">Hoy</option>
            <option value="semana">Esta semana</option>
            <option value="mes">Este mes</option>
            <option value="trimestre">Este trimestre</option>
            <option value="anio">Este a√±o</option>
            <option value="personalizado">Personalizado</option>
          </select>
        </div>
        
        <!-- 
          FILTRO OPCIONAL POR UBICACI√ìN GEOGR√ÅFICA
          Prop√≥sito: Filtrar datos por regi√≥n geogr√°fica espec√≠fica
          Caracter√≠stica: Campo opcional para refinamiento de b√∫squeda
        -->
        <div class="filtro-grupo">
          <label for="ubicacion">Ubicaci√≥n</label>
          <select id="ubicacion">
            <option value="">Todas las ubicaciones</option>
            <option value="norte">Regi√≥n Norte</option>
            <option value="sur">Regi√≥n Sur</option>
            <option value="este">Regi√≥n Este</option>
            <option value="oeste">Regi√≥n Oeste</option>
            <option value="andes">Regi√≥n Andina</option>
            <option value="amazonia">Amazon√≠a</option>
            <option value="pacifico">Pac√≠fico</option>
            <option value="caribe">Caribe</option>
          </select>
        </div>
        
        <!-- 
          FILTRO OPCIONAL POR BRIGADA DE CAMPO
          Prop√≥sito: Filtrar datos por equipo de trabajo espec√≠fico
          Caracter√≠stica: Campo opcional para an√°lisis por grupo de trabajo
        -->
        <div class="filtro-grupo">
          <label for="brigada">Brigada</label>
          <select id="brigada">
            <option value="">Todas las brigadas</option>
            <option value="brigada1">Brigada Norte</option>
            <option value="brigada2">Brigada Sur</option>
            <option value="brigada3">Brigada Este</option>
            <option value="brigada4">Brigada Oeste</option>
            <option value="brigada5">Brigada Andina</option>
          </select>
        </div>
      </div>
      
      <!-- 
        FILTROS DE FECHA PERSONALIZADA
        Prop√≥sito: Mostrar campos de fecha cuando se selecciona "Personalizado"
        Comportamiento: Se muestra/oculta din√°micamente mediante JavaScript
      -->
      <div class="filtros-fecha" id="filtros-fecha" style="display: none;">
        <div class="filtro-grupo">
          <label for="fecha-inicio">Fecha Inicio</label>
          <input type="date" id="fecha-inicio">
        </div>
        
        <div class="filtro-grupo">
          <label for="fecha-fin">Fecha Fin</label>
          <input type="date" id="fecha-fin">
        </div>
      </div>
      
      <!-- 
        BOTONES PARA GESTIONAR LOS FILTROS
        Prop√≥sito: Acciones para aplicar o limpiar los filtros seleccionados
      -->
      <div class="botones-filtros">
        <button class="btn-limpiar" id="btnLimpiarFiltros">Limpiar Filtros</button>
        <button class="btn-aplicar" id="btnAplicarFiltros">Aplicar Filtros</button>
      </div>
    </div>
    
    <!-- 
      SECCI√ìN DE VISTA PREVIA DEL REPORTE
      Prop√≥sito: Mostrar una previsualizaci√≥n del reporte antes de la exportaci√≥n
    -->
    <div class="vista-previa">
      <h2>Vista Previa del Reporte</h2>
      
      <!-- 
        TARJETAS CON ESTAD√çSTICAS R√ÅPIDAS DEL REPORTE
        Prop√≥sito: Presentar m√©tricas clave de forma visualmente atractiva
        Dise√±o: Grid de 4 tarjetas con n√∫meros destacados y descripciones
      -->
      <div class="estadisticas-rapidas">
        <div class="estadistica-item">
          <span class="estadistica-numero" id="total-arboles">0</span>
          <span class="estadistica-texto">√Årboles Registrados</span>
        </div>
        <div class="estadistica-item">
          <span class="estadistica-numero" id="total-suelos">0</span>
          <span class="estadistica-texto">Muestras de Suelo</span>
        </div>
        <div class="estadistica-item">
          <span class="estadistica-numero" id="total-especies">0</span>
          <span class="estadistica-texto">Especies Diferentes</span>
        </div>
        <div class="estadistica-item">
          <span class="estadistica-numero" id="avance">0%</span>
          <span class="estadistica-texto">Avance del Inventario</span>
        </div>
      </div>
      
      <!-- 
        CONTENEDOR PARA LOS GR√ÅFICOS DEL REPORTE
        Prop√≥sito: √Årea dedicada para la visualizaci√≥n de datos gr√°ficos
        Estructura: Dos gr√°ficos principales lado a lado en disposici√≥n responsive
      -->
      <div class="graficos-reporte">
        <div class="grafico-container">
          <h3>Distribuci√≥n de Especies</h3>
          <!-- 
            CANVAS PARA EL GR√ÅFICO CIRCULAR DE DISTRIBUCI√ìN DE ESPECIES
            Prop√≥sito: Renderizar gr√°fico de torta/tarta usando Chart.js
            ID: "graficoEspecies" para referencia en JavaScript
          -->
          <canvas id="graficoEspecies"></canvas>
        </div>
        
        <div class="grafico-container">
          <h3>Registros por Mes</h3>
          <!-- 
            CANVAS PARA EL GR√ÅFICO DE BARRAS DE REGISTROS POR MES
            Prop√≥sito: Renderizar gr√°fico de barras usando Chart.js
            ID: "graficoRegistros" para referencia en JavaScript
          -->
          <canvas id="graficoRegistros"></canvas>
        </div>
      </div>
      
      <!-- 
        TABLA CON RESUMEN DETALLADO DE LOS DATOS
        Prop√≥sito: Presentar datos tabulares detallados del reporte
        Caracter√≠stica: Datos cargados din√°micamente mediante JavaScript
      -->
      <div class="tabla-resumen">
        <h3>Resumen de Datos</h3>
        <table class="tabla-datos">
          <thead>
            <tr>
              <th>Especie</th>
              <th>Cantidad</th>
              <th>Altura Promedio (m)</th>
              <th>Di√°metro Promedio (cm)</th>
              <th>Condici√≥n</th>
            </tr>
          </thead>
          <tbody id="tabla-datos-body">
            <!-- 
              LAS FILAS DE DATOS SE INSERTAR√ÅN DIN√ÅMICAMENTE MEDIANTE JAVASCRIPT
              Prop√≥sito: Contenedor para datos generados program√°ticamente
              ID: "tabla-datos-body" para manipulaci√≥n v√≠a DOM
            -->
          </tbody>
        </table>
      </div>
    </div>
    
    <!-- 
      SECCI√ìN DE OPCIONES DE EXPORTACI√ìN
      Prop√≥sito: Permitir al usuario exportar el reporte en diferentes formatos
    -->
    <div class="opciones-exportacion">
      <h2>Opciones de Exportaci√≥n</h2>
      
      <!-- 
        SELECTOR DE FORMATO DE EXPORTACI√ìN
        Prop√≥sito: Elegir el formato de archivo para la exportaci√≥n
        Dise√±o: Grupo de botones de radio para selecci√≥n √∫nica
      -->
      <div class="formatos-exportacion">
        <div class="formato-opcion">
          <input type="radio" id="formato-pdf" name="formato" value="pdf" checked>
          <label for="formato-pdf">PDF (Formato de documento)</label>
        </div>
        
        <div class="formato-opcion">
          <input type="radio" id="formato-csv" name="formato" value="csv">
          <label for="formato-csv">CSV (Datos en tabla)</label>
        </div>
        
        <div class="formato-opcion">
          <input type="radio" id="formato-excel" name="formato" value="excel">
          <label for="formato-excel">Excel (Hoja de c√°lculo)</label>
        </div>
      </div>
      
      <!-- 
        BOTONES DE ACCI√ìN PARA EXPORTAR Y COMPARTIR
        Prop√≥sito: Ejecutar las acciones principales de exportaci√≥n y distribuci√≥n
      -->
      <div class="botones-exportacion">
        <button class="btn-exportar" id="btnExportar">
          <span class="btn-icon">üìä</span>
          Generar y Exportar Reporte
        </button>
        
        <button class="btn-compartir" id="btnCompartir">
          <span class="btn-icon">üìß</span>
          Compartir por Correo
        </button>
      </div>
    </div>
    
    <!-- 
      MENSAJE QUE SE MUESTRA CUANDO NO HAY DATOS PARA EL REPORTE
      Prop√≥sito: Comunicar al usuario la ausencia de datos y ofrecer alternativas
      Comportamiento: Se muestra/oculta din√°micamente seg√∫n disponibilidad de datos
    -->
    <div class="sin-datos" id="sinDatos" style="display: none;">
      <div class="sin-datos-icon">üìù</div>
      <h3>No hay datos para el reporte solicitado</h3>
      <p>No se encontraron registros que coincidan con los filtros aplicados.</p>
      <div class="sugerencias">
        <p><strong>Sugerencias:</strong></p>
        <ul>
          <li>Ampl√≠e el rango de fechas seleccionado</li>
          <li>Seleccione una ubicaci√≥n diferente</li>
          <li>Verifique que existan datos para el per√≠odo seleccionado</li>
        </ul>
      </div>
      <button class="btn-alternativo" id="btnVerTodos">Ver Todos los Registros</button>
    </div>
  </main>

  <!-- ===== PIE DE P√ÅGINA ===== -->
  <footer>
    <div class="footer-container">
      <p>üìç Direcci√≥n: Calle 25 D No. 110911, Colombia</p>
      <p>üìß Correo: contacto@ideam.gov.co | ‚òé Tel: +57 (601) 4442060</p>
      <div class="redes-sociales">
        <a href="https://www.facebook.com/ideam.instituto/?locale=es_LA"><img src="../IMG/facebook.png" alt="Facebook"></a>
        <a href="https://x.com/IDEAMColombia?ref_src=twsrc%5Egoogle%7Ctwcamp%5Eserp%7Ctwgr%5Eauthor"><img src="../IMG/X.jpeg" alt="X"></a>
        <a href="https://www.instagram.com/ideamcolombia/?hl=es"><img src="../IMG/instagram.png" alt="Instagram"></a>
        <a href="https://www.youtube.com/@InstitutoIDEAM"><img src="../IMG/youtube.png" alt="YouTube"></a>
      </div>
      <p>&copy; 2024 Proyecto Web IFN. Todos los derechos reservados.</p>
    </div>
  </footer>

  <!-- ===== SCRIPT CON LA L√ìGICA DE LA APLICACI√ìN ===== -->
  <script>
    /**
     * MANEJO DEL EVENTO DOMCONTENTLOADED
     * Prop√≥sito: Ejecutar el c√≥digo cuando el DOM est√© completamente cargado
     * Garantiza que todos los elementos HTML est√©n disponibles para manipulaci√≥n
     */
    document.addEventListener('DOMContentLoaded', function() {
      // ===== DECLARACI√ìN DE VARIABLES Y ELEMENTOS DEL DOM =====
      
      // Referencias a elementos de filtros
      const periodoSelect = document.getElementById('periodo');
      const filtrosFecha = document.getElementById('filtros-fecha');
      
      // Referencias a botones de acci√≥n
      const btnAplicarFiltros = document.getElementById('btnAplicarFiltros');
      const btnLimpiarFiltros = document.getElementById('btnLimpiarFiltros');
      const btnExportar = document.getElementById('btnExportar');
      const btnCompartir = document.getElementById('btnCompartir');
      const btnVerTodos = document.getElementById('btnVerTodos');
      
      // Referencia al contenedor de mensaje sin datos
      const sinDatos = document.getElementById('sinDatos');
      
      // ===== CONFIGURACI√ìN DE EVENT LISTENERS =====
      
      /**
       * EVENT LISTENER PARA CAMBIO EN SELECTOR DE PER√çODO
       * Prop√≥sito: Mostrar/ocultar filtros de fecha personalizada
       * L√≥gica: Si se selecciona "personalizado", muestra los campos de fecha
       */
      periodoSelect.addEventListener('change', function() {
        if (this.value === 'personalizado') {
          filtrosFecha.style.display = 'flex'; // Muestra los filtros de fecha
        } else {
          filtrosFecha.style.display = 'none'; // Oculta los filtros de fecha
        }
      });
      
      /**
       * EVENT LISTENER PARA BOT√ìN APLICAR FILTROS
       * Prop√≥sito: Ejecutar la generaci√≥n de vista previa con filtros aplicados
       */
      btnAplicarFiltros.addEventListener('click', function() {
        generarVistaPrevia(); // Funci√≥n que procesa los filtros y actualiza la vista
      });
      
      /**
       * EVENT LISTENER PARA BOT√ìN LIMPIAR FILTROS
       * Prop√≥sito: Restablecer todos los filtros a sus valores por defecto
       */
      btnLimpiarFiltros.addEventListener('click', function() {
        // Resetea todos los selects de filtros
        document.querySelectorAll('.filtros-grid select').forEach(select => {
          select.value = '';
        });
        
        // Resetea los filtros principales
        document.getElementById('tipo-reporte').value = '';
        document.getElementById('periodo').value = '';
        filtrosFecha.style.display = 'none'; // Oculta filtros de fecha
        
        // Limpia la vista previa mostrada
        limpiarVistaPrevia();
      });
      
      /**
       * EVENT LISTENER PARA BOT√ìN EXPORTAR
       * Prop√≥sito: Iniciar el proceso de exportaci√≥n del reporte
       */
      btnExportar.addEventListener('click', function() {
        // Obtiene el formato seleccionado (PDF, CSV o Excel)
        const formato = document.querySelector('input[name="formato"]:checked').value;
        exportarReporte(formato); // Funci√≥n que maneja la exportaci√≥n
      });
      
      /**
       * EVENT LISTENER PARA BOT√ìN COMPARTIR
       * Prop√≥sito: Iniciar el proceso de compartir reporte por correo
       */
      btnCompartir.addEventListener('click', function() {
        compartirReporte(); // Funci√≥n que maneja el env√≠o por correo
      });
      
      /**
       * EVENT LISTENER PARA BOT√ìN VER TODOS
       * Prop√≥sito: Mostrar todos los registros sin aplicar filtros
       */
      btnVerTodos.addEventListener('click', function() {
        // Limpia los filtros principales
        document.getElementById('periodo').value = '';
        document.getElementById('ubicacion').value = '';
        document.getElementById('brigada').value = '';
        
        // Regenera la vista previa con todos los datos
        generarVistaPrevia();
      });
      
      // ===== FUNCIONES PRINCIPALES DE LA APLICACI√ìN =====
      
      /**
       * GENERA LA VISTA PREVIA DEL REPORTE APLICANDO LOS FILTROS SELECCIONADOS
       * Prop√≥sito: Procesar filtros, cargar datos y actualizar la interfaz
       * Simula una llamada a la base de datos y actualiza la interfaz
       */
      function generarVistaPrevia() {
        // Muestra indicador de carga (en implementaci√≥n real)
        mostrarCarga();
        
        // Simula un retardo de carga de datos (1.5 segundos)
        setTimeout(function() {
          // ===== DATOS DE EJEMPLO PARA DEMOSTRACI√ìN =====
          const datosEjemplo = {
            totalArboles: 142,     // Total de √°rboles registrados
            totalSuelos: 28,       // Total de muestras de suelo
            totalEspecies: 18,     // Total de especies diferentes
            avance: '65%',         // Porcentaje de avance del inventario
            especies: [            // Array con datos detallados por especie
              { 
                nombre: 'Quercus humboldtii', 
                cantidad: 42, 
                altura: 18.5, 
                diametro: 45.2, 
                condicion: 'Excelente' 
              },
              { 
                nombre: 'Ceroxylon quindiuense', 
                cantidad: 28, 
                altura: 22.3, 
                diametro: 38.7, 
                condicion: 'Buena' 
              },
              { 
                nombre: 'Anacardium excelsum', 
                cantidad: 15, 
                altura: 15.8, 
                diametro: 52.1, 
                condicion: 'Regular' 
              },
              { 
                nombre: 'Cedrela odorata', 
                cantidad: 12, 
                altura: 20.1, 
                diametro: 41.5, 
                condicion: 'Buena' 
              },
              { 
                nombre: 'Swietenia macrophylla', 
                cantidad: 8, 
                altura: 17.6, 
                diametro: 48.9, 
                condicion: 'Excelente' 
              }
            ]
          };
          
          // ===== ACTUALIZACI√ìN DE ESTAD√çSTICAS R√ÅPIDAS =====
          document.getElementById('total-arboles').textContent = datosEjemplo.totalArboles;
          document.getElementById('total-suelos').textContent = datosEjemplo.totalSuelos;
          document.getElementById('total-especies').textContent = datosEjemplo.totalEspecies;
          document.getElementById('avance').textContent = datosEjemplo.avance;
          
          // ===== ACTUALIZACI√ìN DE LA TABLA DE DATOS =====
          const tablaBody = document.getElementById('tabla-datos-body');
          tablaBody.innerHTML = ''; // Limpia la tabla existente
          
          // Itera sobre cada especie y crea una fila en la tabla
          datosEjemplo.especies.forEach(especie => {
            const fila = document.createElement('tr'); // Crea elemento tr (table row)
            fila.innerHTML = `
              <td>${especie.nombre}</td>
              <td>${especie.cantidad}</td>
              <td>${especie.altura}</td>
              <td>${especie.diametro}</td>
              <td>${especie.condicion}</td>
            `;
            tablaBody.appendChild(fila); // A√±ade la fila a la tabla
          });
          
          // ===== GENERACI√ìN DE GR√ÅFICOS =====
          generarGraficos();
          
          // Oculta el mensaje de "sin datos" ya que ahora hay informaci√≥n
          sinDatos.style.display = 'none';
          
          // Oculta el indicador de carga
          ocultarCarga();
        }, 1500); // Fin del setTimeout (simula carga de datos)
      }
      
      /**
       * LIMPIA TODA LA VISTA PREVIA DEL REPORTE
       * Prop√≥sito: Restablecer la interfaz a estado inicial
       * Restablece estad√≠sticas, tabla y gr√°ficos a valores por defecto
       */
      function limpiarVistaPrevia() {
        // Restablece las estad√≠sticas a cero
        document.getElementById('total-arboles').textContent = '0';
        document.getElementById('total-suelos').textContent = '0';
        document.getElementById('total-especies').textContent = '0';
        document.getElementById('avance').textContent = '0%';
        
        // Limpia el contenido de la tabla
        document.getElementById('tabla-datos-body').innerHTML = '';
        
        // ===== LIMPIEZA DE GR√ÅFICOS EXISTENTES =====
        const graficoEspecies = document.getElementById('graficoEspecies');
        const graficoRegistros = document.getElementById('graficoRegistros');
        
        // Destruye instancias anteriores de gr√°ficos si existen
        if (window.graficoEspeciesInstancia) {
          window.graficoEspeciesInstancia.destroy();
        }
        
        if (window.graficoRegistrosInstancia) {
          window.graficoRegistrosInstancia.destroy();
        }
        
        // Muestra el mensaje indicando que no hay datos
        sinDatos.style.display = 'block';
      }
      
      /**
       * GENERA Y RENDERIZA LOS GR√ÅFICOS USANDO CHART.JS
       * Prop√≥sito: Crear visualizaciones gr√°ficas de los datos
       * Crea un gr√°fico circular para especies y uno de barras para registros
       */
      function generarGraficos() {
        // ===== GR√ÅFICO CIRCULAR - DISTRIBUCI√ìN DE ESPECIES =====
        const ctxEspecies = document.getElementById('graficoEspecies').getContext('2d');
        window.graficoEspeciesInstancia = new Chart(ctxEspecies, {
          type: 'pie', // Tipo de gr√°fico circular
          data: {
            labels: [
              'Quercus humboldtii', 
              'Ceroxylon quindiuense', 
              'Anacardium excelsum', 
              'Cedrela odorata', 
              'Swietenia macrophylla', 
              'Otras'
            ],
            datasets: [{
              data: [42, 28, 15, 12, 8, 37], // Valores para cada categor√≠a
              backgroundColor: [               // Colores para cada segmento
                '#4CAF50', '#2196F3', '#FF9800', '#9C27B0', '#F44336', '#607D8B'
              ]
            }]
          },
          options: {
            responsive: true, // El gr√°fico se adapta al tama√±o del contenedor
            plugins: {
              legend: {
                position: 'right', // Leyenda a la derecha del gr√°fico
              },
              title: {
                display: true,
                text: 'Distribuci√≥n por Especie' // T√≠tulo del gr√°fico
              }
            }
          }
        });
        
        // ===== GR√ÅFICO DE BARRAS - REGISTROS POR MES =====
        const ctxRegistros = document.getElementById('graficoRegistros').getContext('2d');
        window.graficoRegistrosInstancia = new Chart(ctxRegistros, {
          type: 'bar', // Tipo de gr√°fico de barras
          data: {
            labels: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun'], // Eje X - meses
            datasets: [
              {
                label: '√Årboles', // Etiqueta para la primera serie
                data: [25, 32, 28, 41, 36, 30], // Valores para √°rboles
                backgroundColor: '#4CAF50' // Color verde para √°rboles
              }, 
              {
                label: 'Suelos', // Etiqueta para la segunda serie
                data: [8, 10, 6, 12, 9, 7], // Valores para suelos
                backgroundColor: '#2196F3' // Color azul para suelos
              }
            ]
          },
          options: {
            responsive: true, // Gr√°fico responsivo
            scales: {
              y: {
                beginAtZero: true // El eje Y comienza en 0
              }
            }
          }
        });
      }
      
      /**
       * SIMULA LA EXPORTACI√ìN DEL REPORTE EN EL FORMATO ESPECIFICADO
       * @param {string} formato - Formato de exportaci√≥n (pdf, csv, excel)
       * Prop√≥sito: Manejar la generaci√≥n y descarga del reporte
       */
      function exportarReporte(formato) {
        // Cambia el texto del bot√≥n para indicar proceso en curso
        btnExportar.innerHTML = '<span class="btn-icon">‚è≥</span> Generando...';
        btnExportar.disabled = true; // Deshabilita el bot√≥n durante el proceso
        
        // Simula el tiempo de generaci√≥n del reporte (2 segundos)
        setTimeout(function() {
          // Muestra alerta de √©xito (en implementaci√≥n real descargar√≠a el archivo)
          alert(`Reporte generado exitosamente en formato ${formato.toUpperCase()}. El archivo se descargar√° autom√°ticamente.`);
          
          // Restablece el bot√≥n a su estado original
          btnExportar.innerHTML = '<span class="btn-icon">üìä</span> Generar y Exportar Reporte';
          btnExportar.disabled = false;
          
          // En una implementaci√≥n real, aqu√≠ se generar√≠a y descargar√≠a el archivo
          // seg√∫n el formato seleccionado
        }, 2000);
      }
      
      /**
       * SIMULA EL ENV√çO DEL REPORTE POR CORREO ELECTR√ìNICO
       * Prop√≥sito: Permitir al usuario compartir el reporte v√≠a email
       * Solicita el correo destino y muestra confirmaci√≥n
       */
      function compartirReporte() {
        // Solicita al usuario que ingrese un correo electr√≥nico
        const email = prompt('Ingrese el correo electr√≥nico para compartir el reporte:');
        
        // Si el usuario ingres√≥ un correo (no cancel√≥)
        if (email) {
          // Cambia el texto del bot√≥n para indicar env√≠o en curso
          btnCompartir.innerHTML = '<span class="btn-icon">‚è≥</span> Enviando...';
          btnCompartir.disabled = true; // Deshabilita el bot√≥n
          
          // Simula el tiempo de env√≠o (1.5 segundos)
          setTimeout(function() {
            // Muestra confirmaci√≥n de env√≠o exitoso
            alert(`Reporte compartido exitosamente a ${email}`);
            
            // Restablece el bot√≥n a su estado original
            btnCompartir.innerHTML = '<span class="btn-icon">üìß</span> Compartir por Correo';
            btnCompartir.disabled = false;
          }, 1500);
        }
      }
      
      /**
       * MUESTRA UN INDICADOR DE CARGA (PLACEHOLDER PARA IMPLEMENTACI√ìN REAL)
       * Prop√≥sito: Proporcionar feedback visual durante operaciones largas
       * En una implementaci√≥n completa mostrar√≠a un spinner o barra de progreso
       */
      function mostrarCarga() {
        // En una implementaci√≥n real, aqu√≠ se mostrar√≠a un spinner de carga
        console.log('Cargando datos...'); // Mensaje de consola para desarrollo
      }
      
      /**
       * OCULTA EL INDICADOR DE CARGA (PLACEHOLDER PARA IMPLEMENTACI√ìN REAL)
       * Prop√≥sito: Remover el feedback visual cuando finaliza la operaci√≥n
       */
      function ocultarCarga() {
        // En una implementaci√≥n real, aqu√≠ se ocultar√≠a el spinner de carga
        console.log('Datos cargados'); // Mensaje de consola para desarrollo
      }
      
      // ===== INICIALIZACI√ìN DE LA APLICACI√ìN =====
      
      // Inicializa la vista con estado vac√≠o (sin datos)
      limpiarVistaPrevia();
    });
  </script>
  
  <!-- 
    INCLUSI√ìN DE SCRIPTS EXTERNOS
    Prop√≥sito: Cargar funcionalidades adicionales de la aplicaci√≥n
    Orden de carga: 
      1. estadisticas.js - L√≥gica espec√≠fica del m√≥dulo de reportes
      2. auth.js - Sistema de autenticaci√≥n y gesti√≥n de usuarios
      3. buscador-universal.js - Funcionalidad de b√∫squeda en todo el sistema
  -->
  <script src="../JS/estadisticas.js"></script>
  <script src="../JS/auth.js"></script>
  <script src="../JS/buscador-universal.js"></script>
</body>
</html>